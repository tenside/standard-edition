#!/usr/bin/env php
<?php

require __DIR__.'/../src/bootstrap.php';

use Symfony\Component\Console\Formatter\OutputFormatter;
use Symfony\Component\Console\Logger\ConsoleLogger;
use Symfony\Component\Console\Output\ConsoleOutput;
use Tenside\StandardEdition\Compiler;

error_reporting(-1);
ini_set('display_errors', 1);

try {
    $logger   = new ConsoleLogger(new ConsoleOutput(ConsoleOutput::VERBOSITY_VERBOSE, null, new OutputFormatter(true)));
    $compiler = new Compiler($logger);
    $compiler->compile();
} catch (\Exception $e) {
    echo sprintf(
        'Failed to compile phar: [%s] at %s:' . PHP_EOL . '%s' . PHP_EOL,
        get_class($e),
        $e->getMessage(),
        $e->getFile(),
        $e->getLine(),
        $e->getTraceAsString()
    );
    exit(1);
}
